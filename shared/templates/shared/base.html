<!DOCTYPE html>
{% load staticfiles %}
<html>
  <head>
    <!-- FROM Google Fonts (citation [3])-->
    <link href="https://fonts.googleapis.com/css?family=Sacramento" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Pinyon+Script" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Katibeh" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Quattrocento" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Vibur" rel="stylesheet">
    <!-- END CITATION -->
    <script src='https://www.google.com/recaptcha/api.js'></script>
    <script src="{% static "shared/jquery-3.1.1.min.js" %}" ></script><!--"https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>-->
  </head>
  <body>
    <style>
      /* asterisk selector from citation [6] */
      * {
        font-family:"Quattrocento", serif;
        color:#778;
      }
      html {
        height:100%;
      }
      body {
        background-color: #fdfdfd; /* HTML color picker used (citation [2] in top-level repository README) */
        padding:0px;
        margin:0px;
        font-family: 'Quattrocento', serif;
        height:100%;
      }
      #inheritorContent {
        height:100%;
      }
      #navigationBar {
        background-color: #fafaf6; /* used hex color picker, citation [2] in top-level repository README */
        height:50px; /* citation [4] */
        position:fixed;
        top:0px;
        left:0px;
        width:100%;
        border-bottom: 1px solid rgba(237, 237, 229, 0.5);/*#eaeae2;*/ /* used hex colorpicker, citation [2] in top-level repository README */
        z-index:10;
      }
      #homepageButton {
        font-family:'Vibur', serif;
        font-size:25px;
        text-decoration: none;
        font-weight:bold;
        color:#778;
      }
      #homepageButtonWrapper {
        margin:6px 10px 5px 25px; /* citation [4] */
        display:inline-block;
        vertical-align:top;
      }
      #navigationBarButtonWrapper {
        float:right;
        display:inline;
        padding:10px 30px 10px 10px; /* citation [4] */
      }
      .navigationBarButton {
        padding:5px 10px 5px 10px;
        display:inline-block;
        vertical-align:top
      }
      .navigationBarButtonLinks {
        font-size:25px;
        text-decoration:none;
        color:#778;
        font-family:'Katibeh', serif;
      }
      #searchDiv {
        width:200px;
        display:inline-block;
        background-color:#fff;
      }
      #searchText {
        padding:10px;
        border:none;
        width:100%;
        box-sizing:border-box;
      }
      #searchMatches {
        width:100%;
        max-height:80%;
        overflow-y:scroll;
        background-color:#334;
      }
      .match {
        display:inline-block;
        height:50px;
        margin:5px;
      }
      .matchLink {
        text-decoration:none;
        vertical-align:top;
        color:#fff;
      }
      .matchLinkDiv {
        display:inline-block;
        vertical-align:50%;
      }
      .matchThumbnail {
        height:100%;
        margin-right:5px;
        display:inline-block;
      }
      #usersOwnLink {
        height:100%;
      }
      #usersOwnLink > img {
        height:100%;
        padding:7px;
        box-sizing:border-box;
      }
    </style>
    <!-- NAV BAR USAGE INSPIRED BY THE COMMON USAGE OF IT AROUND THE WEB -->
    <div id="navigationBar">
      <div id="homepageButtonWrapper">
        <a href="{% url 'homepage' %}" id="homepageButton">rogger</a>
      </div>
      <a href="{% url "userView" user.username %}" id="usersOwnLink"><img src="{{ user.userinfo.thumbURL }}" /></a>
      <!-- NAV BAR USAGE INSPIRED BY THE COMMON USAGE OF IT AROUND THE WEB -->
      <div id="navigationBarButtonWrapper">
        {% if user.is_authenticated %}
        <div id="searchDiv">
          <input type="text" id="searchText" oninput="sendSearch()" placeholder="user search" onfocusout="hideSearchResults()" onfocusin="showSearchResults()"/>
          <div id="searchMatches" onmouseover="disableHiding()" onmouseout="enableHiding()" hidden>
          </div>
        </div>
        <div class="navigationBarButton">
          <a class="navigationBarButtonLinks" href="{% url 'newEntryView' %}">{{ newLog }}</a>
        </div>
        <div class="navigationBarButton">
          <a class="navigationBarButtonLinks" href="{% url 'settingsView' %}"> {{ settings }}</a>
        </div>
        <div class="navigationBarButton">
          <a class="navigationBarButtonLinks" href="{% url 'logout' %}">{{ logout }}</a>
        </div>
        {% endif %}
        <div class="navigationBarButton">
          <a class="navigationBarButtonLinks" href="{% url 'about' %}">{{ about }}</a>
        </div>
      </div>
    </div>
    <div id="inheritorContent">
    {% block inheritor %}
    {% endblock %}
    </div>
  </body>
  <script>
    var hidingEnabled = true;
    var focusLost     = false;
    function sendSearch() {
      $.ajax("{% url "search" %}", {
        method  : "POST",
        data    : {
          // next line from citation [15]
          csrfmiddlewaretoken : "{{ csrf_token }}",
          searchphrase        : $("#searchText")[0].value
        },
        success : function(ajaxResponseText, ajaxStatus, ajaxResponse) {
          $("#searchMatches").html(ajaxResponseText);
        },
        error   : function(ajaxResponse, ajaxStatus, ajaxError) {
          alert(ajaxResponse.responseText);
        }
      })
    }

    function hideSearchResults() {
      if (hidingEnabled) {
        $("#searchMatches")[0].hidden = true;
      } else {
        focusLost = true;
      }
    }

    function showSearchResults() {
      $("#searchMatches")[0].hidden = false;
      focusLost = false;
    }

    function enableHiding() {
      if (focusLost) {
        $("#searchMatches")[0].hidden = true;
      }
      hidingEnabled = true;
      console.log("hiding enabled");
    }

    function disableHiding() {
      hidingEnabled = false;
      console.log("hiding disabled");
    }
  </script>
</html>
